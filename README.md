# New Product Game

一款结合了算术逻辑与空间博弈的策略棋盘游戏。

## 核心玩法

* **棋盘结构**：一个 6x6 的格网，每个格子里随机分布着 1~9 乘法表中的数字（不重复，一共36个）。
* **因数轨道**：底部有 1~9 的数字刻度，以及两个移动滑块（A 和 B）。
* **占领格子**：玩家通过移动其中一个滑块，使 A × B 的乘积对应棋盘上的格子，从而占领该格子。

## 详细规则

1. **开局（第 1 步）**：玩家 1 放置滑块 A，不占领格子。
2. **建立连接（第 2 步）**：玩家 2 放置滑块 B，产生第一个乘积并占领对应格子。
3. **常规回合**：玩家轮流移动 A 或 B。必须移动，且新乘积对应的格子必须未被占领。
4. **获胜条件**：率先在棋盘上形成连续的连线（横/纵/斜）， 可在设置中自定义（默认为4）。如果当前玩家移动 A 或 B 到任何位置产生的乘积都已被占领，则该玩家无路可走，被迫投降

---

## 项目开发文档

### 1. 技术栈

* **框架**: React (Vite)
* **样式**: CSS3 (Flexbox/Grid/Animations)
* **逻辑**: JavaScript (ES6+)

### 2. 核心功能实现

胜负判定(`getWinningLine`)采用了八方向搜索算法。每当新棋子落下，从该点出发探测水平、垂直、两条对角线。如果该方向连子数 ，返回所有中招格子的索引数组用于高亮动画

AI调度系统：
支持“人类 vs AI”、“AI vs AI”以及随时切换

#### **双重重置机制 (Reset Logic)**

为了提升用户体验，系统区分了两种重置行为：

* **硬重置 (Hard Reset)**：点击页面顶部的标题 "New Product Game"。系统将重新生成一个完全随机的数字布局棋盘，并清空所有对局状态。
* **软重置 (Soft Reset)**：在设置菜单中修改“连珠数 (Win Count)”或手动触发重置。系统将**保留当前棋盘的数字布局**，仅擦除已占领的棋子颜色并重头开始。这允许玩家在同一布局下挑战不同的获胜规则。

#### **智能 AI 系统**

* **贪心算法**：AI 会优先寻找能够立即获胜的移动；如果没有，则会尝试封堵玩家即将成线的路径。
* **动态难度**：支持在设置中调整 AI 逻辑。
* **思考模拟**：内置 `THINKING_TIME` 延迟，提供更自然的博弈反馈。

#### **交互优化**

* **合法性预判**：当玩家选择滑块时，数字轨道会自动高亮或置灰（`forbidden` 状态），实时提示哪些数字会导致“已被占领”的冲突。
* **响应式设计**：完美适配移动端与桌面端。

### 3. 文件结构

* `src/App.jsx`: 核心状态机，处理双重重置逻辑、回合切换及胜负判定。
* `src/ai.js`: 封装 AI 决策算法，包含贪心策略与合法性校验。
* `src/constants.js`: 存储全局配置，如 `GRID_SIZE`, `FACTOR_RANGE` 等。
* `src/i18n.js`: 国际化字典，支持中英文实时切换。

### 4. 后续开发规划

* AI性能飞跃

方案 A：贪心算法（简单 / 初级）。AI只看当前这一步。逻辑：遍历所有合法位置，计算每个位置产生的乘积。优先级：如果一步能成胜利所需的连接(WIN_COUNT)，直接下。如果一步能堵住玩家的获胜连接，必须堵。否则，随机选一个

方案 B：启发式评估 + Minimax 算法（中级）。AI 会模拟“我走一步，你走一步”的过程。评分函数：给棋盘状态打分。例如，自己连成 2 个：+10 分。自己连成 3 个：+100 分。对方连成 3 个：-500 分。占据中心区域：+5 分。搜索深度：由于分支因子极小，搜索 4-6 层（即预测双方各走 3 步）即可

方案 C：蒙特卡洛树搜索（MCTS）（高级），类似 AlphaGo 的简化版。AI 通过成千上万次的随机自我对弈来判断哪一个动作的胜率最高。优点：不需要复杂的评分函数，能发现人类难以察觉的阴招。缺点：在 JavaScript 中实现较复杂，性能开销比 Minimax 大

* 游戏功能

本地战绩记录：使用 `localStorage` 记录玩家与不同难度 AI 的胜负比。记录落子顺序，实现回放、悔棋功能
另外增加一些统计功能方便后期研究，比如研究先手赢的概率

* 联网对战